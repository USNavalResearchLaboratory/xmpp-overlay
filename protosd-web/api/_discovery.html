<h1>Service Discovery from the Web API</h1>

<p>There are a number of ways of discovery lists of services that have been discovered using ProtoSD
and one of its underlying bindings to JmDNS or INDI.  You can grab a high-level list of services,
a detailed list containing all of the details of all services, or query for individual services or
search for services in various ways. This sections describes this functionality in depth.</p>

<div class="blackbox">
    http://localhost/api/services
</div>


<h2>1. List Services</h2>
<div class="rounded nicebox" style="width: 900px;">
    <div class="floatleft blackbox">
        Command: <br>
        Parameters: <br>
        Verb: <br>
        Consumes: <br>
        Produces:<br>
    </div>

    <div class="floatleft blackbox">
        api/services/{id} <br>
        {id} <br>
        GET  <br>
        none <br>
        application/json, application/xml<br>
    </div>

    <div class="verticalspace"></div>

    <div class="floatleft whitebox" style="width: 430px">
        A GET on the base services url and specifying the ID of the service discovery system
        returns a list of the current services discovered on this system. This provides a
        high level view of each service, showing only the name, type and domain for the service.
    </div>
    <div class="clear"></div>
</div>

<p>This command gets the list of discovered services and an example of the output XML is:

<pre class="brush: xml;">
<serviceOverviewList>
    <ServiceInfo>
        <name>Printer</name>
        <type>_http._tcp</type>
        <domain>local._tcp.local</domain>
    </ServiceInfo>
    <ServiceInfo>
        <name>ians-air (2)</name>
        <type>_afpovertcp._tcp</type>
        <domain>local</domain>
    </ServiceInfo>
</serviceOverviewList>
</pre>

<p>The actual return type is determined by setting the "Accept" field in the HTTP header to specify what
you are prepared to accept as a return value.</p>


<h2>2. List details of all Services</h2>
<div class="rounded nicebox" style="width: 900px;">
    <div class="floatleft blackbox">
        Command: <br>
        Parameters: <br>
        Verb: <br>
        Consumes: <br>
        Produces:<br>
    </div>

    <div class="floatleft blackbox">
        api/services/{id}/detail <br>
        {id} <br>
        GET  <br>
        none <br>
        application/json, application/xml<br>
    </div>

    <div class="verticalspace"></div>

    <div class="floatleft whitebox" style="width: 430px">
        A GET on the base services url, specifying the ID of the service discovery system, with
        "detail" appended returns a detailed list of the current services discovered on this system.
    </div>
    <div class="clear"></div>
</div>

<p>This command gets the detailed list of discovered services, e.g.:

<pre class="brush: xml;">
<serviceInfoMetadataList>
    <ServiceInfoEndpoint>
        <protosdID>1</protosdID>
        <serviceID>42</serviceID>
        <hostID>ians-air-2.local</hostID>
        <name>Printer</name>
        <type>_http._tcp</type>
        <domain>local._tcp.local</domain>
        <address>192.168.1.104</address>
        <port>8888</port>
        <txt>
            <entry>
                <key>PSID</key>
                <value>29</value>
            </entry>
            <entry>
                <key>pages_left</key>
                <value>78</value>
            </entry>
            <entry>
                <key>paper</key>
                <value>low</value>
            </entry>
            <entry>
                <key>DiscoverySystem</key>
                <value>JmDNS</value>
            </entry>
            <entry>
                <key>ink</key>
                <value>high</value>
            </entry>
      </txt>
    </ServiceInfoEndpoint>
    <ServiceInfoEndpoint>
        <protosdID>1</protosdID>
        <serviceID>41</serviceID>
        <hostID>ians-air-2.local</hostID>
        <name>ians-air (2)</name>
        <type>_afpovertcp._tcp</type>
        <domain>local</domain>
        <address>192.168.1.104</address>
        <port>548</port>
        <txt>
            <entry>
                <key>PSID</key>
                <value>0</value>
            </entry>
        </txt>
    </ServiceInfoEndpoint>
    </serviceInfoMetadataList>
</pre>

<p>Again, the return type is determined by setting the "Accept" field in the HTTP header to application/json or xml.</p>


<h2>3. Search For Services By Transport Protocol</h2>
<div class="rounded nicebox" style="width: 900px;">
    <div class="floatleft blackbox">
        Command: <br>
        Parameters: <br>
        Verb: <br>
        Consumes: <br>
        Produces:<br>
    </div>

    <div class="floatleft blackbox">
        api/services/{id}/findtransport/{protocol}<br>
        {id} and {protocol}<br>
        GET  <br>
        none <br>
        application/json, application/xml<br>
    </div>

    <div class="verticalspace"></div>

    <div class="floatleft whitebox" style="width: 380px">
        A GET against the service discovery system ID with the "findtransport" name with a
        transport specified e.g. udp or tcp, returns a list of services with that transport type.
        <br>
        <br>
    </div>
    <div class="clear"></div>
</div>

<br>
<p>For example:</p>

<pre class="brush: xml;">
http://localhost:8080/api/services/1/findtransport/tcp
</pre>



<h2>4. Search For Services By Application Type</h2>
<div class="rounded nicebox" style="width: 900px;">
    <div class="floatleft blackbox">
        Command: <br>
        Parameters: <br>
        Verb: <br>
        Consumes: <br>
        Produces:<br>
    </div>

    <div class="floatleft blackbox">
        api/services/{id}/findapp/{application}<br>
        {id} and {application}<br>
        GET  <br>
        none <br>
        application/json, application/xml<br>
    </div>

    <div class="verticalspace"></div>

    <div class="floatleft whitebox" style="width: 380px">
        A GET against the service discovery system ID with the "findapp" name with an
        application type specified e.g. http, daap, etc, returns a list of services with
        that application type.
        <br>
        <br>
    </div>
    <div class="clear"></div>
</div>

<pre class="brush: xml;">
http://localhost:8080/api/services/1/findapp/http
</pre>



<h2>5. Search For Services By Service Type</h2>
<div class="rounded nicebox" style="width: 900px;">
    <div class="floatleft blackbox">
        Command: <br>
        Parameters: <br>
        Verb: <br>
        Consumes: <br>
        Produces:<br>
    </div>

    <div class="floatleft blackbox">
        api/services/{id}/find/{type}<br>
        {id} and {type}<br>
        GET  <br>
        none <br>
        application/json, application/xml<br>
    </div>

    <div class="verticalspace"></div>

    <div class="floatleft whitebox" style="width: 380px">
        A GET against the service discovery system ID with the "find" name with a
        service type specified e.g. _afpovertcp._tcp, _http._tcp etc, returns a
        list of services with that service type.
        <br>
        <br>
    </div>
    <div class="clear"></div>
</div>

<pre class="brush: xml;">
http://localhost:8080/api/services/1/find/_afpovertcp._tcp
</pre>


<h2>6. Search For Services By Service Type And Name</h2>
<div class="rounded nicebox" style="width: 900px;">
    <div class="floatleft blackbox">
        Command: <br>
        Parameters: <br>
        Verb: <br>
        Consumes: <br>
        Produces:<br>
    </div>

    <div class="floatleft blackbox">
        api/services/{id}/find/{type}/{name}<br>
        {id}, {type} and {name}<br>
        GET  <br>
        none <br>
        application/json, application/xml<br>
    </div>

    <div class="verticalspace"></div>

    <div class="floatleft whitebox" style="width: 380px">
        A GET against the service discovery system ID with the "find" name with a
        service type specified e.g. _afpovertcp._tcp, _http._tcp etc, and
        a service name returns the service details of that service type and name pair.
        <br>
    </div>
    <div class="clear"></div>
</div>

<pre class="brush: xml;">
http://localhost:8080/api/services/1/find/_afpovertcp._tcp/ians-air
</pre>